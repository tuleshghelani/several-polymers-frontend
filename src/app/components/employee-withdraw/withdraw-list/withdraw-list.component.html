<div class="withdraw-list-container">
    <app-loader [show]="isLoading"></app-loader>
    
    <div class="search-section card">
      <h2>Search Withdraws</h2>
      <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
        <div class="search-controls">
          <div class="form-group">
            <input 
              type="text" 
              formControlName="search" 
              class="form-control" 
              placeholder="Search by employee name..."
            >
          </div>
          <div class="form-group">
            <div class="product-select-group">
              <app-searchable-select
                formControlName="employeeId"
                [options]="employees"
                labelKey="name"
                valueKey="id"
                [defaultOption]="{ label: 'All Employees', value: '' }"
                [searchPlaceholder]="'Search employees...'"
              ></app-searchable-select>
              <button 
                type="button" 
                class="btn btn-sm btn-primary refresh"
                style="margin-top: 3px;"
                (click)="refreshEmployees()" 
                [disabled]="isLoadingEmployees"
                title="Refresh Employees"
              >
                <i class="fas" [ngClass]="isLoadingEmployees ? 'fa-spinner fa-spin' : 'fa-sync-alt'"></i>
              </button>
            </div>
          </div>
          
          <div class="form-group">
            <input 
              type="date" 
              formControlName="startDate" 
              class="form-control" 
              placeholder="Start Date"
            >
          </div>
          <div class="form-group">
            <input 
              type="date" 
              formControlName="endDate" 
              class="form-control" 
              placeholder="End Date"
            >
          </div>
          <div class="button-group">
            <button type="submit" class="search-btn btn btn-sm btn-primary">
              <i class="fas fa-search"></i> Search
            </button>
            <button type="button" class="search-btn btn btn-sm btn-secondary" (click)="resetForm()">
              <i class="fas fa-undo"></i> Reset
            </button>
          </div>
        </div>
      </form>
    </div>
      <button class="btn btn-sm btn-primary mb-2" (click)="addWithdraw()">Add Withdraw</button>
    <div class="withdraws-list card">
      <h2>Withdraws</h2>
  
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th>No</th>
              <th>Employee Name</th>
              <th>Withdraw Date</th>
              <th>Amount</th>
              <th>Remarks</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let w of withdraws; let index = index">
              <td>{{ startIndex + index + 1 }}</td>
              <td>{{ w.employeeName }}</td>
              <td>{{ w.withdrawDate | date:'dd-MM-yyyy' }}</td>
              <td>{{ w.payment | currency:'INR' }}</td>
              <td>{{ w.remarks || '-' }}</td>
              <td class="actions">                
                <button 
                  class="btn-icon edit" 
                  (click)="editWithdraw(w.id!)"
                  title="Edit Withdraw"
                >
                  <i class="fas fa-edit"></i>
                </button>
                <button 
                  class="btn-icon delete" 
                  (click)="deleteWithdraw(w.id!)"
                  title="Delete Withdraw"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <app-pagination
        *ngIf="totalPages > 0"
        [currentPage]="currentPage"
        [pageSize]="pageSize"
        [totalElements]="totalElements"
        [pageSizeOptions]="pageSizeOptions"
        (pageChange)="onPageChange($event)"
        (pageSizeChange)="onPageSizeChange($event)"
      ></app-pagination>
      
    </div>
  </div>

<app-confirm-modal
  [show]="showDeleteModal"
  [title]="'Confirm Delete'"
  [message]="'Are you sure you want to delete this withdraw?'"
  (confirm)="onDeleteConfirm()"
  (cancel)="onDeleteCancel()"
></app-confirm-modal>


