<div class="user-container">
  <div class="search-section card">
    <h2><i class="fas fa-search"></i> Search Users</h2>
    <div class="card-content">
      <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
        <div class="search-controls">
          <div class="form-group">
            <input 
              type="text" 
              formControlName="searchTerm" 
              class="form-control" 
              placeholder="Search users by name, email, or phone..."
            >
          </div>
          <div class="form-group">
            <select formControlName="status" class="form-control">
              <option value="">All Status</option>
              <option value="A">Active</option>
              <option value="I">Inactive</option>
            </select>
          </div>
          <div class="button-group">
            <button type="submit" class="search-btn btn btn-sm btn-primary">
              <i class="fas fa-search"></i> Search
            </button>
            <button type="button" class="search-btn btn btn-sm btn-secondary" (click)="resetForm()">
              <i class="fas fa-undo"></i> Reset
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="action-buttons">
    <button routerLink="/user/create" class="btn btn-sm btn-primary">
      <i class="fas fa-plus"></i> Add User
    </button>
  </div>

  <div class="users-list card">
    <h2><i class="fas fa-users"></i> Users</h2>
    <div class="table-wrapper">
      <div class="table-container">
        <app-loader [show]="isLoading"></app-loader>
        
        <div class="table-responsive" [class.loading]="isLoading">
          <table class="table">
            <thead>
              <tr>
                <th><i class="fas fa-user"></i> Name</th>
                <th><i class="fas fa-phone"></i> Phone</th>
                <th><i class="fas fa-envelope"></i> Email</th>
                <th><i class="fas fa-user-tag"></i> Roles</th>
                <th><i class="fas fa-toggle-on"></i> Status</th>
                <th><i class="fas fa-cogs"></i> Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of users" class="user-row">
                <td class="user-name">{{user.firstName}} {{user.lastName}}</td>
                <td>{{user.phoneNumber}}
                  <button class="btn-icon whatsapp" title="Open WhatsApp" (click)="openWhatsApp(user.phoneNumber)">
                    <i class="fab fa-whatsapp"></i>
                  </button></td>
                <td>{{user.email}}</td>
                <td>
                  <div class="roles-container">
                    <span class="roles-badge" *ngFor="let role of user.roles">
                      {{role}}
                    </span>
                  </div>
                </td>
                <td>
                  <span class="status-badge" [ngClass]="{'active': user.status === 'A', 'inactive': user.status !== 'A'}">
                    {{user.status === 'A' ? 'Active' : 'Inactive'}}
                  </span>
                </td>
                <td class="actions">
                  <button 
                    class="btn-icon edit" 
                    [routerLink]="['/user/edit', user.id]"
                    title="Edit User"
                  >
                    <i class="fas fa-edit"></i>
                  </button>
                  <button 
                    class="btn-icon delete" 
                    (click)="deleteUser(user.id!)"
                    title="Delete User"
                  >
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
              <tr *ngIf="!users?.length">
                <td colspan="6" class="text-center" style="padding: 40px; color: var(--text-secondary); font-style: italic;">
                  <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                  No users found
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="card-content" *ngIf="totalPages > 0">
      <app-pagination
        [currentPage]="currentPage"
        [pageSize]="pageSize"
        [totalElements]="totalElements"
        [pageSizeOptions]="pageSizeOptions"
        (pageChange)="onPageChange($event)"
        (pageSizeChange)="onPageSizeChange($event)"
      ></app-pagination>
    </div>
  </div>
</div>
