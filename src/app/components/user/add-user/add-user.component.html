<div class="user-form-container">
  <app-loader [show]="isLoading"></app-loader>
  
  <div class="form-card">
    <div class="card-header">
      <h2 class="form-title">
        <i class="fas fa-user"></i> 
        {{ isEditMode ? 'Edit User' : 'Create User' }}
      </h2>
    </div>

    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
      <div class="form-row">
        <div class="form-group">
          <label for="firstName">
            <i class="fas fa-user"></i> First Name <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="firstName"
            formControlName="firstName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('firstName')"
            placeholder="Enter first name"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('firstName')">
            {{ getFieldError('firstName') }}
          </div>
        </div>

        <div class="form-group">
          <label for="lastName">
            <i class="fas fa-user"></i> Last Name <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="lastName"
            formControlName="lastName"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('lastName')"
            placeholder="Enter last name"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('lastName')">
            {{ getFieldError('lastName') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="phoneNumber">
            <i class="fas fa-phone"></i> Phone Number <span class="required">*</span>
          </label>
          <input 
            type="tel" 
            id="phoneNumber"
            formControlName="phoneNumber"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('phoneNumber')"
            placeholder="+1234567890"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('phoneNumber')">
            {{ getFieldError('phoneNumber') }}
          </div>
        </div>

        <div class="form-group">
          <label for="email">
            <i class="fas fa-envelope"></i> Email <span class="required">*</span>
          </label>
          <input 
            type="email" 
            id="email"
            formControlName="email"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('email')"
            placeholder="user@example.com"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('email')">
            {{ getFieldError('email') }}
          </div>
        </div>
      </div>

      <div class="form-row" *ngIf="!isEditMode">
        <div class="form-group">
          <label for="password">
            <i class="fas fa-lock"></i> Password <span class="required">*</span>
          </label>
          <input 
            type="password" 
            id="password"
            formControlName="password"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('password')"
            placeholder="Enter password"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('password')">
            {{ getFieldError('password') }}
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">
            <i class="fas fa-lock"></i> Confirm Password <span class="required">*</span>
          </label>
          <input 
            type="password" 
            id="confirmPassword"
            formControlName="confirmPassword"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('confirmPassword')"
            placeholder="Confirm password"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('confirmPassword')">
            {{ getFieldError('confirmPassword') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="status">
            <i class="fas fa-toggle-on"></i> Status <span class="required">*</span>
          </label>
          <select 
            id="status"
            formControlName="status"
            class="form-control"
            [class.is-invalid]="isFieldInvalid('status')"
          >
            <option value="">Select Status</option>
            <option *ngFor="let option of statusOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
          <div class="invalid-feedback" *ngIf="isFieldInvalid('status')">
            {{ getFieldError('status') }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>
          <i class="fas fa-users"></i> Roles <span class="required">*</span>
        </label>
        <div class="roles-container">
          <div class="role-checkbox" *ngFor="let role of availableRoles">
            <input 
              type="checkbox" 
              [id]="'role-' + role"
              [checked]="isRoleSelected(role)"
              (change)="onRoleChange(role, $event)"
              class="role-input"
            >
            <label [for]="'role-' + role" class="role-label">
              {{ role }}
            </label>
          </div>
        </div>
        <div class="invalid-feedback" *ngIf="isFieldInvalid('roles')">
          {{ getFieldError('roles') }}
        </div>
      </div>

      <div class="form-actions">
        <button type="button" routerLink="/user" class="btn btn-secondary">
          <i class="fas fa-arrow-left"></i> Cancel
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="isLoading">
          <i class="fas fa-save"></i> 
          {{ isEditMode ? 'Update User' : 'Create User' }}
        </button>
      </div>
    </form>
  </div>
</div>
