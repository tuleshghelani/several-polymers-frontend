<!-- Premium Enquiry Management Interface -->
<div class="enquiry-container" role="main" aria-label="Enquiry Management">
  <!-- Loading Overlay -->
  <app-loader [show]="isLoading" aria-live="polite"></app-loader>
  
  <!-- Hero Section with Breadcrumb -->
  <div class="hero-section">
    <div class="hero-content">
      <div class="breadcrumb" role="navigation" aria-label="Breadcrumb">
        <span class="breadcrumb-item">
          <i class="fas fa-home" aria-hidden="true"></i>
          <span class="sr-only">Home</span>
        </span>
        <i class="fas fa-chevron-right breadcrumb-separator" aria-hidden="true"></i>
        <span class="breadcrumb-item">Customer Relations</span>
        <i class="fas fa-chevron-right breadcrumb-separator" aria-hidden="true"></i>
        <span class="breadcrumb-item active" aria-current="page">Enquiry Management</span>
      </div>
      <h1 class="hero-title">
        <i class="fas fa-question-circle hero-icon" aria-hidden="true"></i>
        Enquiry Management
      </h1>
      <p class="hero-subtitle">Manage customer enquiries with advanced filtering and comprehensive tracking</p>
    </div>
    <div class="hero-stats">
      <div class="stat-card">
        <div class="stat-value">{{ totalElements }}</div>
        <div class="stat-label">Total Enquiries</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ enquiries.length }}</div>
        <div class="stat-label">Current View</div>
      </div>
    </div>
  </div>

  <!-- Advanced Search Section -->
  <div class="search-section glass-card" role="search" aria-label="Enquiry Search Filters">
    <div class="search-header">
      <h2 class="search-title">
        <i class="fas fa-filter search-icon" aria-hidden="true"></i>
        Advanced Search & Filters
      </h2>
      <div class="search-actions">
        <button 
          type="button" 
          class="btn-icon-only collapse-btn"
          aria-label="Toggle search filters"
          title="Toggle search filters"
        >
          <i class="fas fa-chevron-up" aria-hidden="true"></i>
        </button>
      </div>
    </div>
    
    <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="search-form" novalidate>
      <!-- Single Row Filters -->
      <div class="filters-row">
        <div class="form-group">
          <label for="search" class="filter-label">
            <i class="fas fa-calendar" aria-hidden="true"></i>
            Start Date
          </label>
          <input 
            type="date" 
            formControlName="startDate" 
            class="form-control filter-input" 
            placeholder="Start Date"
            aria-describedby="startDate-help"
          >
        </div>
        <div class="form-group">
          <label for="endDate" class="filter-label">
            <i class="fas fa-calendar" aria-hidden="true"></i>
            End Date
          </label>
          <input 
            type="date" 
            formControlName="endDate" 
            class="form-control filter-input" 
            placeholder="End Date"
            aria-describedby="endDate-help"
          >
        </div>
        <!-- Search Input -->
        <div class="filter-group search-group">
          <!-- <label for="search" class="filter-label">
            <i class="fas fa-search" aria-hidden="true"></i>
            Search
          </label> -->
          <div class="">
            <input 
              id="search"
              type="text" 
              formControlName="search" 
              class="form-control filter-input" 
              placeholder="Search enquiries..."
              aria-describedby="search-help"
            >
            <!-- <i class="fas fa-search input-icon" aria-hidden="true"></i> -->
          </div>
        </div>

        <!-- Status Filter -->
        <div class="filter-group">
          <!-- <label for="status" class="filter-label">
            <i class="fas fa-flag" aria-hidden="true"></i>
            Status
          </label> -->
          <div class="">
            <select 
              id="status"
              formControlName="status" 
              class="form-control filter-select"
              aria-describedby="status-help"
            >
              <option *ngFor="let s of statusOptions" [value]="s.value">{{ s.label }}</option>
            </select>
            <!-- <i class="fas fa-chevron-down select-icon" aria-hidden="true"></i> -->
          </div>
        </div>
        
        <!-- Type Filter -->
        <!-- <div class="filter-group">
          <label for="type" class="filter-label">
            <i class="fas fa-tag" aria-hidden="true"></i>
            Type
          </label>
          <div class="select-wrapper">
            <select 
              id="type"
              formControlName="type" 
              class="form-control filter-select"
              aria-describedby="type-help"
            >
              <option *ngFor="let t of typeOptions" [value]="t.value">{{ t.label }}</option>
            </select>
            <i class="fas fa-chevron-down select-icon" aria-hidden="true"></i>
          </div>
        </div> -->

        <!-- Action Buttons -->
        <div class="filter-actions">
          <button 
            type="button" 
            class="btn btn-secondary btn-reset" 
            (click)="resetForm()"
            [disabled]="isLoading"
            aria-label="Reset all search filters"
            title="Reset Filters"
          >
            <i class="fas fa-undo" aria-hidden="true"></i>
            <span class="btn-text">Reset</span>
          </button>
          <button 
            type="submit" 
            class="btn btn-primary btn-search" 
            [disabled]="isLoading"
            aria-label="Apply search filters"
            title="Apply Filters"
          >
            <i class="fas fa-search" aria-hidden="true"></i>
            <span class="btn-text">Search</span>
            <div class="btn-loader" *ngIf="isLoading">
              <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
            </div>
          </button>
        </div>
      </div>

      <!-- Search Info -->
      <div class="search-info-bar">
        <span class="results-count" *ngIf="totalElements > 0">
          <i class="fas fa-info-circle" aria-hidden="true"></i>
          Showing {{ enquiries.length }} of {{ totalElements }} enquiries
        </span>
      </div>
    </form>
  </div>

  <!-- Quick Actions Bar -->
  <div class="quick-actions-bar">
    <div class="actions-left">
      <div class="view-options">
        <button class="btn-icon-only view-btn active" title="Table view" aria-label="Table view">
          <i class="fas fa-table" aria-hidden="true"></i>
        </button>
        <button class="btn-icon-only view-btn" title="Card view" aria-label="Card view">
          <i class="fas fa-th-large" aria-hidden="true"></i>
        </button>
      </div>
    </div>
    <div class="actions-right">
      <button 
        class="btn btn-primary add-enquiry-btn"
        (click)="createNewEnquiry()"
        aria-label="Create new enquiry"
      >
        <i class="fas fa-plus" aria-hidden="true"></i>
        <span>New Enquiry</span>
      </button>
    </div>
  </div>

  <!-- Enquiries Data Section -->
  <div class="enquiries-section glass-card" role="region" aria-label="Enquiry Data Table">
    <div class="section-header">
      <div class="section-title-group">
        <h2 class="section-title">
          <i class="fas fa-database section-icon" aria-hidden="true"></i>
          Customer Enquiries
        </h2>
        <p class="section-description">Comprehensive view of all customer enquiries with detailed information</p>
      </div>
      <div class="section-actions">
        <div class="sort-controls">
          <label for="sortBy" class="sr-only">Sort by</label>
          <select id="sortBy" class="sort-select" aria-label="Sort enquiries by">
            <option value="date">Latest First</option>
            <option value="name">Name</option>
            <option value="status">Status</option>
            <option value="type">Type</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Table Container -->
    <div class="table-container">
      <div class="table-responsive" role="region" aria-label="Enquiry data table" tabindex="0">
        <table class="data-table" role="table">
          <thead role="rowgroup">
            <tr role="row">
              <th scope="col" class="col-number">
                <div class="th-content">
                  <span>No.</span>
                </div>
              </th>
              <th scope="col" class="col-name sortable">
                <div class="th-content">
                  <i class="fas fa-user" aria-hidden="true"></i>
                  <span>Name</span>
                  <i class="fas fa-sort sort-icon" aria-hidden="true"></i>
                </div>
              </th>
              <th scope="col" class="col-contact">
                <div class="th-content">
                  <i class="fas fa-phone" aria-hidden="true"></i>
                  <span>Contact</span>
                </div>
              </th>
              <th scope="col" class="col-subject sortable">
                <div class="th-content">
                  <i class="fas fa-tag" aria-hidden="true"></i>
                  <span>Subject</span>
                  <i class="fas fa-sort sort-icon" aria-hidden="true"></i>
                </div>
              </th>
              <th scope="col" class="col-type">
                <div class="th-content">
                  <i class="fas fa-building" aria-hidden="true"></i>
                  <span>Type</span>
                </div>
              </th>
              <th scope="col" class="col-status">
                <div class="th-content">
                  <i class="fas fa-toggle-on" aria-hidden="true"></i>
                  <span>Status</span>
                </div>
              </th>
              <th scope="col" class="col-location">
                <div class="th-content">
                  <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                  <span>Location</span>
                </div>
              </th>
              <th scope="col" class="col-date sortable">
                <div class="th-content">
                  <i class="fas fa-calendar-day" aria-hidden="true"></i>
                  <span>Created</span>
                  <i class="fas fa-sort sort-icon" aria-hidden="true"></i>
                </div>
              </th>
              <th scope="col" class="col-actions">
                <div class="th-content">
                  <i class="fas fa-tools" aria-hidden="true"></i>
                  <span>Actions</span>
                </div>
              </th>
            </tr>
          </thead>
          <tbody role="rowgroup">
            <tr 
              *ngFor="let enquiry of enquiries; let index = index; trackBy: trackByEnquiryId" 
              role="row"
              class="data-row"
              [attr.aria-rowindex]="startIndex + index + 1"
            >
              <td role="gridcell" class="cell-number">
                <div class="cell-content">
                  <span class="row-number">{{ startIndex + index + 1 }}</span>
                </div>
              </td>
              <td role="gridcell" class="cell-name">
                <div class="cell-content">
                  <div class="name-display">
                    <div class="name-avatar">
                      <i class="fas fa-user" aria-hidden="true"></i>
                    </div>
                    <div class="name-info">
                      <span class="name-value">{{ enquiry.name }}</span>
                    </div>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-contact">
                <div class="cell-content">
                  <div class="contact-display">
                    <div class="contact-item">
                      <i class="fas fa-phone contact-icon" aria-hidden="true"></i>
                      <span class="contact-value">{{ enquiry.mobile }}</span>
                    </div>
                    <div class="contact-item">
                      <i class="fas fa-envelope contact-icon" aria-hidden="true"></i>
                      <span class="contact-value">{{ enquiry.mail }}</span>
                    </div>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-subject">
                <div class="cell-content">
                  <div class="subject-display">
                    <span class="subject-value" [title]="enquiry.subject">{{ enquiry.subject }}</span>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-type">
                <div class="cell-content">
                  <div class="type-badge" [class]="getTypeBadgeClass(enquiry.type)">
                    <i class="fas" [class]="enquiry.type === 'Corporate' ? 'fa-building' : 'fa-user'" aria-hidden="true"></i>
                    <span>{{ getTypeLabel(enquiry.type) }}</span>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-status">
                <div class="cell-content">
                  <div class="status-badge" [class]="getStatusBadgeClass(enquiry.status)">
                    <i class="fas" [class]="enquiry.status === 'P' ? 'fa-clock' : enquiry.status === 'W' ? 'fa-check-circle' : 'fa-times-circle'" aria-hidden="true"></i>
                    <span>{{ getStatusLabel(enquiry.status) }}</span>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-location">
                <div class="cell-content">
                  <div class="location-display">
                    <i class="fas fa-map-marker-alt location-icon" aria-hidden="true"></i>
                    <span class="location-value">{{ enquiry.city }}, {{ enquiry.state }}</span>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-date">
                <div class="cell-content">
                  <div class="date-display">
                    <span class="date-value">{{ formatDate(enquiry.createdAt) }}</span>
                  </div>
                </div>
              </td>
              <td role="gridcell" class="cell-actions">
                <div class="cell-content">
                  <div class="action-buttons" role="group" [attr.aria-label]="'Actions for enquiry ' + enquiry.name">
                    <button 
                      class="btn-action btn-edit" 
                      (click)="editEnquiry(enquiry.id)"
                      [attr.aria-label]="'Edit enquiry ' + enquiry.name"
                      title="Edit enquiry"
                    >
                      <i class="fas fa-edit" aria-hidden="true"></i>
                    </button>
                    <!-- <button 
                      class="btn-action btn-view" 
                      (click)="viewEnquiry(enquiry.id)"
                      [attr.aria-label]="'View enquiry ' + enquiry.name + ' details'"
                      title="View details"
                    >
                      <i class="fas fa-eye" aria-hidden="true"></i>
                    </button> -->
                    <button 
                      class="btn-action btn-delete" 
                      (click)="deleteEnquiry(enquiry.id, enquiry.name)"
                      [attr.aria-label]="'Delete enquiry ' + enquiry.name"
                      title="Delete enquiry"
                    >
                      <i class="fas fa-trash-alt" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </td>
            </tr>
            
            <!-- Empty State -->
            <tr *ngIf="!enquiries?.length && !isLoading" role="row" class="empty-row">
              <td colspan="9" role="gridcell" class="empty-cell">
                <div class="empty-state">
                  <div class="empty-icon">
                    <i class="fas fa-search" aria-hidden="true"></i>
                  </div>
                  <h3 class="empty-title">No Enquiries Found</h3>
                  <p class="empty-description">
                    No enquiries match your current search criteria.
                    Try adjusting your filters or create a new enquiry.
                  </p>
                  <button class="btn btn-primary empty-action" (click)="createNewEnquiry()">
                    <i class="fas fa-plus" aria-hidden="true"></i>
                    Create First Enquiry
                  </button>
                </div>
              </td>
            </tr>
            
            <!-- Loading State -->
            <tr *ngIf="isLoading" role="row" class="loading-row">
              <td colspan="9" role="gridcell" class="loading-cell">
                <div class="loading-state">
                  <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
                  </div>
                  <p class="loading-text">Loading enquiry data...</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- Pagination Section -->
    <div class="pagination-section" *ngIf="totalPages > 0 && !isLoading">
      <div class="pagination-info">
        <span class="pagination-text">
          Showing {{ startIndex + 1 }} to {{ getEndIndex() }} of {{ totalElements }} entries
        </span>
      </div>
      <app-pagination
        [currentPage]="currentPage"
        [pageSize]="pageSize"
        [totalElements]="totalElements"
        [pageSizeOptions]="pageSizeOptions"
        (pageChange)="onPageChange($event)"
        (pageSizeChange)="onPageSizeChange($event)"
        aria-label="Enquiry data pagination"
      ></app-pagination>
    </div>
  </div>
</div>
