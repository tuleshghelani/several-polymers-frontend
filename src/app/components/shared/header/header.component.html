<header class="header">
  <nav class="nav-container">
    <div class="nav-top">
      <div class="logo">
        <span>Several Polymers</span>
      </div>
      
      <div class="user-info" *ngIf="isAuthenticated">
        <!-- <span class="user-name">{{ getUserDisplayName() }}</span> -->
        <span class="user-roles">{{ getUserRoles() }}</span>
      </div>
      
      <button class="mobile-menu-toggle" (click)="toggleMobileMenu()" *ngIf="isAuthenticated">
        <i class="fas" [class.fa-bars]="!isMobileMenuOpen" [class.fa-times]="isMobileMenuOpen"></i>
      </button>
    </div>

    <div class="nav-content" [class.show]="isMobileMenuOpen" *ngIf="isAuthenticated">
      <ul class="nav-links">
        <!-- Master Menu -->
        <li class="dropdown" *ngIf="hasMasterMenuItems()">
          <a (click)="toggleMasterMenu($event)" [class.active]="isMasterActive()">
            <i class="fas fa-th-large"></i> Master
            <i class="fas fa-chevron-down"></i>
          </a>
          <ul class="dropdown-menu" [class.show]="showMasterMenu">
            <li *ngIf="permissions.canViewCategory">
              <a routerLink="/category" routerLinkActive="active">
                <i class="fas fa-tags"></i> Category
              </a>
            </li>
            <li *ngIf="permissions.canViewProduct">
              <a routerLink="/product" routerLinkActive="active">
                <i class="fas fa-box"></i> Product
              </a>
            </li>
            <li *ngIf="permissions.canViewCustomer">
              <a routerLink="/customer" routerLinkActive="active">
                <i class="fas fa-users"></i> Customer
              </a>
            </li>
            <li *ngIf="permissions.canViewEmployee">
              <a routerLink="/employee" routerLinkActive="active">
                <i class="fas fa-user-tie"></i> Employee
              </a>
            </li>
            <li *ngIf="permissions.canViewMachine">
              <a routerLink="/machine" routerLinkActive="active">
                <i class="fas fa-cogs"></i> Machine
              </a>
            </li>
            <li *ngIf="permissions.canViewTransport">
              <a routerLink="/transport-master" routerLinkActive="active">
                <i class="fas fa-truck"></i> Transport
              </a>
            </li>
            <li *ngIf="permissions.canViewBrand">
              <a routerLink="/brand" routerLinkActive="active">
                <i class="fas fa-certificate"></i> Brand
              </a>
            </li>
            <li *ngIf="permissions.canViewUser">
              <a routerLink="/user" routerLinkActive="active">
                <i class="fas fa-user-cog"></i> Users
              </a>
            </li>
            <li *ngIf="permissions.canViewEnquiry">
              <a routerLink="/enquiry" routerLinkActive="active">
                <i class="fas fa-question-circle"></i> Enquiry
              </a>
            </li>
            <li *ngIf="permissions.canViewFollowup">
              <a routerLink="/followup" routerLinkActive="active">
                <i class="fas fa-university"></i>Followup
              </a>
            </li>
            <li *ngIf="permissions.canViewPayment">
              <a routerLink="/payment-history" routerLinkActive="active">
                <i class="fas fa-money-bill-wave"></i> Payment
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Transaction Menu -->
        <li class="dropdown" *ngIf="hasTransactionMenuItems()">
          <a (click)="toggleTransactionMenu($event)" [class.active]="isTransactionActive()">
            <i class="fas fa-exchange-alt"></i> Transaction
            <i class="fas fa-chevron-down"></i>
          </a>
          <ul class="dropdown-menu" [class.show]="showTransactionMenu">
            <li *ngIf="permissions.canViewPurchase">
              <a routerLink="/purchase" routerLinkActive="active">
                <i class="fas fa-shopping-cart"></i> Purchase
              </a>
            </li>
            <li *ngIf="permissions.canViewSale">
              <a routerLink="/sale" routerLinkActive="active">
                <i class="fas fa-hand-holding-usd"></i> Sale
              </a>
            </li>            
          </ul>
        </li>
        
        
        <li class="dropdown" *ngIf="hasTransactionMenuItems()">
          <a (click)="toggleDispatchQuotationMenu($event)" [class.active]="isDispatchQuotationActive()">
            <i class="fas fa-exchange-alt"></i> Dispatch Quotation
            <i class="fas fa-chevron-down"></i>
          </a>
          <ul class="dropdown-menu" [class.show]="showDispatchQuotationMenu">            
            <li *ngIf="permissions.canViewQuotation">
              <a routerLink="/quotation" routerLinkActive="active" fullPath>
                <i class="fas fa-hand-holding-usd"></i> Quotation
              </a>
            </li> 
            <li *ngIf="permissions.canViewDispatchQuotation">
              <a routerLink="/quotation/dispatch-list" routerLinkActive="active" fullPath>
                <i class="fas fa-shopping-cart"></i> Dispatch Quotation
              </a>
            </li>           
          </ul>
        </li>

        <!-- Employee Menu -->
        <li class="dropdown" *ngIf="hasEmployeeMenuItems()">
          <a (click)="toggleEmployeeMenu($event)" [class.active]="isEmployeeActive()">
            <i class="fas fa-users"></i> Employee
            <i class="fas fa-chevron-down"></i>
          </a>
          <ul class="dropdown-menu" [class.show]="showEmployeeMenu">
            <li *ngIf="permissions.canViewEmployeeWithdraw">
              <a routerLink="/attendance" routerLinkActive="active">
                <i class="fas fa-clipboard-list"></i> Attendance
              </a>
            </li>
            <li *ngIf="permissions.canViewEmployeeWithdraw">
              <a routerLink="/employee-withdraw" routerLinkActive="active">
                <i class="fas fa-clipboard-list"></i> Employee Withdraw
              </a>
            </li>
          </ul>
        </li>
        
        <!-- Employee Order (standalone) -->
        <li *ngIf="permissions.canViewEmployeeOrder"> 
          <a routerLink="/employee-order" routerLinkActive="active"> 
            <i class="fas fa-clipboard-list"></i> Operator
          </a>
        </li>
        <li *ngIf="permissions.canViewBatch"> 
          <a routerLink="/batch" routerLinkActive="active">
            <i class="fas fa-clipboard-list"></i> Batch
          </a>
        </li>
      </ul>

      <div class="nav-actions">
        <button class="btn btn-logout" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>
  </nav>
</header>
